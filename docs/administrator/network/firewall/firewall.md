# 방화벽

## 방화벽 목록
모든 **매니지먼트 노드**에 대한 인바운드 네트워크 **방화벽 규칙**을 목록으로 보여줍니다. 규칙은 우선순위(위에서 아래로)에 따라 적용되며, **‘*’ 표시된 규칙은 기본 규칙**으로 목록의 최하단에 위치합니다.

### 주요 작업
- `편집`: 방화벽 룰들을 생성/편집/삭제할 수 있습니다.

### 테이블 컬럼
방화벽 목록은 다음과 같은 컬럼으로 구성된 표 형태로 표시됩니다:


| 컬럼           | 설명                                                         |
|--------------|------------------------------------------------------------|
| **규칙 번호**    | 규칙의 우선순위 번호입니다. 작은 번호의 규칙이 먼저 적용되며, `*` 표시는 기본 제공되는 **기본 규칙**을 의미합니다. |
| **프로토콜**    | 트래픽의 프로토콜 종류입니다. `TCP`/`UDP`/`모든 ICMP`/`전체 트래픽` 중 하나로 표시됩니다. |
| **소스 CIDR** | 규칙이 적용될 소스 IP 대역을 CIDR 표기법으로 나타냅니다. 예: `192.168.0.0/24` |
| **목적지 포트**  | 규칙이 적용될 대상 포트 번호 또는 포트 범위입니다. TCP/UDP의 경우 **포트 번호나 범위**(예: `80`, `1000-2000`)로 표시되며, 프로토콜이 `모든 트래픽` 또는 `모든 ICMP`인 경우 `전체`로 표시됩니다. |
| **허용/거부**   | 트래픽을 허용할지(**ACCEPT**) 거부할지(**DROP**)를 나타냅니다. |
| **활성화 여부**  | 해당 규칙의 적용 활성화 상태를 보여줍니다. `활성화` 또는 `비활성화`로 표시됩니다. 활성화된 규칙만 트래픽에 적용됩니다. |
| **설명**       | 규칙에 대한 설명 또는 메모입니다. |


> 💡 **참고:** 방화벽 **기본 규칙**(규칙 번호 ‘*’)은 시스템에서 자동 제공하는 규칙입니다. 기본 규칙은 수정 또는 삭제가 불가하며, 주로 “나머지 모든 트래픽에 대한 기본 동작”을 정의합니다.

## 방화벽 규칙 편집
인바운드 방화벽 규칙을 추가하거나 순서를 조정하고, 개별 규칙의 상세 설정을 변경할 수 있습니다.

### 주요 작업
- `규칙 추가`: 새로운 방화벽 규칙 행을 추가할 수 있습니다. 추가된 규칙은 기본값으로 모든 프로토콜/모든 IP/모든 포트를 허용하도록 설정되지만 **비활성화** 상태로 생성됩니다. 사용자는 필요한 대로 각 필드를 수정해야 합니다.
- `삭제`: 각 규칙 행의 우측 끝에 있는 [삭제] 버튼을 클릭하여 해당 규칙을 제거할 수 있습니다. 단, **활성화된 규칙은 삭제 버튼이 비활성화**되어 있으며, 삭제하려면 먼저 규칙을 비활성화해야 합니다.
- `저장`: 변경사항을 적용합니다. (저장 후 방화벽 규칙이 즉시 업데이트됩니다.)

- **필드 편집:** 각 규칙 행에서는 아래와 같은 필드를 편집할 수 있습니다 (비활성화 상태의 규칙만 편집 가능).
  - **프로토콜:** 드롭다운에서 트래픽 프로토콜을 선택합니다. **TCP/UDP**를 선택하면 포트 필드에 기본값으로 `0-65535`(모든 포트 범위)가 설정되고, **ALL/ICMP**를 선택하면 포트 필드가 자동으로 `ALL`로 지정됩니다.
  - **소스 CIDR:** 허용 또는 차단할 소스 IP 대역을 CIDR로 입력합니다. 예를 들어 `10.0.0.0/8`, 단일 IP는 `/32` 접미사를 붙여 입력합니다 (예: `203.0.113.5/32`). `0.0.0.0/0`으로 입력하면 모든 IP를 의미합니다.
  - **목적지 포트:** 허용 또는 차단할 대상 포트 번호를 입력합니다. 단일 포트 번호(예: `22`)나 범위(`1024-2048`)로 입력할 수 있으며, 모든 포트를 대상으로 할 경우 **ALL**로 설정합니다. 포트 번호는 **1**에서 **65535** 사이의 값이어야 하고, 범위의 경우 시작 포트가 끝 포트보다 작거나 같아야 합니다.
  - **허용/거부:** 드롭다운에서 **허용** 또는 **거부**를 선택합니다. **허용**으로 설정하면 해당 조건의 트래픽을 통과시키고, **거부**로 설정하면 트래픽을 차단합니다.
  - **설명:** 해당 규칙의 설명이나 메모를 입력합니다. 최대 200자까지 입력할 수 있으며, 선택 사항입니다.
  - **활성화 스위치:** 토글 형태의 스위치로 규칙의 적용 여부를 설정합니다. 스위치를 **켜짐(활성화)**으로 하면 해당 규칙이 방화벽에 즉시 적용되고, **꺼짐(비활성화)**으로 하면 적용되지 않습니다. 신규 추가된 규칙은 기본적으로 비활성화 상태이며, 편집 완료 후 필요 시 스위치를 켜서 활성화합니다.

### 입력 필드 유효성

| 필드             | 허용 값 및 범위 | 검증 규칙 및 제한 | 비고 |
| ---------------- | --------------- | ------------------ | ---- |
| **프로토콜**       | `TCP` / `UDP` / `모든 ICMP` / `전체 트래픽`| (필수) 드롭다운에서 선택 | -                                         |
| **소스 CIDR**    | IPv4 CIDR <br/>예: `203.0.113.5/32`, `10.0.0.0/8`, `0.0.0.0/0` | (필수) 유효한 IPv4 CIDR 형식이어야 함 <br/> 단일 IP는 `/32` 접미사 필수 <br/> `0.0.0.0/0`은 모든 IP 대역을 의미 | 허용·차단 대상 소스 IP 범위  |
| **목적지 포트**    | `1`–`65535` 단일 포트 또는 범위 <br/>예: `22`, `1024-2048`, `0-65535`(전체 포트) | (필수) `TCP/UDP`일 때만 직접 입력 가능 <br/> 포트 번호는 `1`–`65535` 범위 | `전체 트래픽`/`모든 ICMP` 선택 시 자동 `전체` |
| **허용/거부**    | `허용` / `거부`| (필수) <br/> `허용`: 조건에 일치하는 트래픽 통과(ACCEPT) <br/> `거부`: 트래픽 차단(DROP)        | 룰 동작 설정   |
| **설명**         | 최대 200자     | (선택) 규칙 설명 및 메모                                 | - |
| **활성화 여부** | `켜짐(활성화)` / `꺼짐(비활성화)` | 활성화 시 저장 후 규칙이 즉시 적용됨. <br/> 일반적으로 **비활성화 상태의 규칙만 편집 가능**   | 규칙 적용/미적용 상태 제어   |


> 💡 **참고:** 규칙들은 드래그 앤 드롭으로 **순서를 변경**할 수 있습니다. 규칙 목록 상단(번호 1)부터 차례로 적용되며, 어떤 규칙에 트래픽이 일치하여 처리되면 이후 규칙들은 평가되지 않습니다. 특정 트래픽을 허용하려면 보다 상위 우선순위(작은 번호)에 허용 규칙을 추가하고, 범용 차단 규칙은 하위 우선순위로 배치해야 합니다.

> ⚠️ **주의:** 
> * **활성화된 규칙은 편집하거나 삭제할 수 없습니다.** 규칙을 수정하거나 삭제하려면 먼저 해당 규칙을 **비활성화**하세요. 또한, 기본 규칙(‘*’)은 시스템 기본값이므로 수정/삭제가 불가합니다.
> * 방화벽 규칙 변경 사항은 저장 즉시 네트워크에 적용되므로, 중요 서비스에 영향이 없도록 신중히 변경해야 합니다.

