# 타겟 그룹

**타겟 그룹**은 로드 밸런서가 트래픽을 분산시킬 대상 서버 그룹입니다.

## 타겟 그룹 목록
### 주요 작업
- `생성`: 새로운 타겟 그룹을 생성합니다.
- `편집`: 선택한 1개 타겟 그룹의 설정을 편집할 수 있습니다.
- `삭제`: 선택한 타겟 그룹들을 삭제합니다.  
  (단, 로드 밸런서 리스너로 설정된 타겟 그룹은 삭제할 수 없습니다.)

### 테이블 컬럼
| 컬럼 | 설명 |
|------|------|
| **이름** | 타겟 그룹의 이름입니다. 클릭 시 상세 화면으로 이동합니다. |
| **생성 방식** | 해당 타겟 그룹의 생성 출처입니다. 사용자가 직접 생성한 경우 `수동 생성`, 시스템(예: 쿠버네티스, 오토 스케일링 그룹)에서 생성한 경우 `쿠버네티스` 또는 `오토 스케일링 그룹`이 표시됩니다. |
| **VPC** | 타겟 그룹이 속한 VPC입니다. |
| **프로토콜** | 타겟 그룹이 사용하는 통신 프로토콜입니다. (예: TCP, UDP) |
| **포트 번호** | 타겟 그룹의 대상 포트 번호입니다. |
| **타겟 유형** | 타겟 그룹의 대상 타입입니다. `인스턴스` 또는 `IP`로 구분됩니다. |
| **로드 밸런서** | 해당 타겟 그룹을 현재 사용 중인 로드 밸런서 존재 여부입니다. `Y`면 하나 이상의 로드 밸런서에서 사용 중이며, `-`는 연결된 로드 밸런서가 없음을 의미합니다. |
| **생성 일시** | 타겟 그룹이 생성된 날짜와 시간입니다. |

---

## 타겟 그룹 상세
### 상단 요약
- **이름**: 타겟 그룹 이름입니다.  
- **ID**: 타겟 그룹이 부여받은 ID입니다.  
- **생성 방식**: 타겟 그룹의 생성 출처입니다.  
- **VPC**: 타겟 그룹이 속한 VPC입니다.  
- **프로토콜**: 타겟 그룹이 사용하는 통신 프로토콜입니다.  
- **포트 번호**: 타겟 그룹의 대상 포트 번호입니다.  
- **타겟 유형**: 인스턴스 또는 IP입니다.  
- **로드 밸런서**: 현재 이 타겟 그룹을 사용 중인 로드 밸런서 이름입니다. (없으면 `-`)  
- **Health Check**
  - **프로토콜**: 상태 검사에 사용하는 통신 프로토콜입니다.
  - **포트 번호**: 상태 검사 포트 번호입니다.
  - **간격**: 상태 검사 간격입니다. (기본 30초)
  - **임계치**: 연속 실패 허용 횟수입니다. (예: 2 → 두 번 실패 시 트래픽 분산 중단)
- **생성 일시**: 생성된 날짜와 시간입니다.
- **설명**: 타겟 그룹 설명입니다.

### 하단 탭
타겟 그룹에 구성된 각 타겟의 상태(헬스 체크 통과 여부 등)를 보여주며, 필요 시 타겟 추가/제거 작업을 수행할 수 있습니다.  
`편집` 버튼 클릭 시 **타겟 편집** 화면으로 이동합니다.

#### 하단 요약
- **인스턴스**: 대상 유형이 인스턴스일 경우 인스턴스 이름과 ID (예: vm-01(ID:29))  
- **인터페이스**: 인스턴스의 인터페이스 이름과 IP 주소 (예: eth0(172.31.1.4))  
- **IP 주소**: 대상 유형이 IP일 경우 설정한 IP  
- **포트 번호**: 타겟 포트 번호  
- **가중치**: 타겟의 가중치  
- **상태**: HEALTHY / UNHEALTHY  

> 💡 **상태가 UNHEALTHY인 경우 트래픽이 분산되지 않습니다.**

---

## 타겟 그룹 생성
타겟 그룹 생성 시 타겟을 바로 등록할 수도 있고, 타겟 그룹만 생성할 수도 있습니다.  
실제 부하 분산을 위해서는 로드밸런서 리스너의 타겟 그룹으로 등록되어야 동작합니다.

### 1. 기본 정보
- **이름**: 타겟 그룹의 이름을 입력합니다.
- **VPC**: 소속될 VPC를 선택합니다.
- **프로토콜**: 타겟 그룹이 사용하는 프로토콜 선택 (예: TCP, UDP)  
- **포트 번호**: 수신할 포트 번호를 입력합니다.  
- **타겟 유형**: `인스턴스` 또는 `IP 주소` 선택

### 2. 고급 상태 검사 설정 (선택)
별도로 설정하지 않으면 타겟 그룹과 동일한 값이 적용됩니다.  
- **상태 검사 프로토콜**: TCP 또는 UDP  
- **상태 검사 포트**: 검사 포트 번호  
- **비정상 임계값**: 비정상으로 판단되는 연속 실패 횟수 (기본 2회)

### 3. 타겟 추가
설정한 타겟 유형에 따라 추가합니다.  
IP 주소 + 포트 조합이 중복되면 추가할 수 없습니다.

#### 인스턴스 타겟
- **인스턴스**: VPC 내 인스턴스 선택  
- **인터페이스**: 해당 인스턴스의 인터페이스  
- **포트 번호**: 타겟 포트 번호  
- **가중치**: 가중치 입력  

#### IP 주소 타겟
- **IP 주소**: IPv4 형식 입력  
- **포트 번호**: 타겟 포트 번호  
- **가중치**: 가중치 입력  

### 타겟 그룹 생성 — 필드 유효성 표
| 필드 | 허용 값 | 검증 규칙 | 비고 |
|------|---------|-----------|------|
| **이름** | 영문/숫자/`-`/`_` | 최대 20자, 공백 불가 | **필수 입력** |
| **VPC** | 현재 프로젝트 VPC | 존재하는 VPC만 선택 | **필수 선택** |
| **프로토콜** | `TCP` \| `UDP` | 값 중 하나 선택 | **필수 선택** |
| **포트** | 1–65535 | 숫자만 입력 | **필수 입력** |
| **대상 타입** | `인스턴스` \| `IP 주소` | 값 중 하나 선택 | **필수 선택** |
| **상태 검사 프로토콜** | `TCP` \| `UDP` | 값 중 하나 선택 | |
| **상태 검사 포트** | 1–65535 | 숫자만 입력 | |
| **상태 검사 실패 임계치** | 정수 | 숫자만 입력 | |
| **설명** | 문자열 | 최대 200자 | |

### 대상(타겟) 추가 — 필드 유효성 표
| 필드 | 허용 값 | 검증 규칙 | 비고 |
|------|---------|-----------|------|
| **대상 타입** | `인스턴스` \| `IP 주소` | 타겟 그룹의 대상 타입과 일치해야 함 | **필수** |
| **인스턴스 선택** *(인스턴스)* | VPC 내 인스턴스 | 존재/상태 확인 불가 | **필수(조건부)** |
| **네트워크 인터페이스(IP)** *(인스턴스)* | 인스턴스 내부 IPv4 | 다중 NIC 중 1개 선택 | **필수(조건부)** |
| **IP 주소 입력** *(IP 타입)* | IPv4 | 유효한 IPv4 | **필수(조건부)** |
| **포트(대상 수신 포트)** | 1–65535 | 숫자만 입력 | **필수** |
| **설명** | 문자열 | 최대 200자 | 선택 |

---

## 타겟 그룹 편집
타겟 그룹의 이름, 설명, 상태 검사 설정(프로토콜/포트/비정상 임계값)을 수정할 수 있습니다.

| 컬럼 | 설명 |
|------|------|
| **이름** | 타겟 그룹의 이름을 변경할 수 있습니다. |
| **상태 검사 프로토콜** | TCP 또는 UDP로 변경할 수 있습니다. |
| **상태 검사 포트** | 상태 검사 포트를 변경할 수 있습니다. |
| **비정상 임계값** | 상태 검사 비정상 임계값을 변경할 수 있습니다. |
| **설명** | 타겟 그룹 설명을 변경할 수 있습니다. |

---

## 타겟 편집
타겟을 `추가`, `편집`, `삭제`할 수 있습니다.  
편집 시 IP 주소, 포트 번호, 가중치를 변경할 수 있습니다.

### 인스턴스 타겟
| 컬럼 | 설명 |
|------|------|
| **인스턴스** | VPC 내 인스턴스 선택 |
| **인터페이스** | 인스턴스 인터페이스 선택 |
| **포트 번호** | 타겟 포트 번호 입력 |
| **가중치** | 부하 분산 가중치 입력 |

### IP 주소 타겟
| 컬럼 | 설명 |
|------|------|
| **IP 주소** | 타겟의 IP 주소 입력 |
| **포트 번호** | 타겟 포트 번호 입력 |
| **가중치** | 부하 분산 가중치 입력 |

> ⚠️ **편집 제한:** Kubernetes 등 **시스템 자동 생성 타겟 그룹은 편집이 제한**됩니다. 타겟 변경은 상세 화면에서만 가능합니다.

---

## 타겟 그룹 삭제
여러 개를 동시에 선택해 삭제할 수 있습니다.  
`삭제` 버튼 클릭 시 **"타겟 그룹을 삭제하시겠습니까?"** 확인 창이 표시됩니다.

> 💡 **주의:** 로드밸런서에 연결된 타겟 그룹은 삭제할 수 없습니다.  
> 삭제하려면 로드 밸런서 상세 화면에서 리스너 삭제(연결 해제)를 먼저 수행해야 합니다.
