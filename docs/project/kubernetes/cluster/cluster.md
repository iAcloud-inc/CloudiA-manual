# 클러스터

## 클러스터 목록
클러스터 목록을 확인합니다.

### 주요 작업
- `생성`: 새 클러스터 생성 페이지로 이동합니다.
- `삭제`: 하나 이상 선택된 클러스터를 삭제합니다. **삭제 중** 상태의 클러스터는 삭제할 수 없습니다.
- 행 클릭: **이름**을 클릭하면 클러스터 상세 화면으로 이동합니다.

### 테이블 컬럼

클러스터 목록은 다음과 같은 컬럼으로 구성된 표 형태로 표시됩니다:

| 컬럼 | 설명 |
|------|------|
| **이름** | 클러스터 표시명입니다. 클릭 시 상세 화면으로 이동합니다. |
| **ID** | 클러스터 고유 식별자입니다. |
| **엔드포인트 IP** | API 서버의 `IPv4` 주소입니다. 외부 도구에서 접근할 때 사용합니다. |
| **상태** | 현재 동작 상태를 아이콘과 컬러 배지로 표시합니다. |
| **컨트롤 플레인** | 정상 노드 수/전체 노드 수를 `1/1` 형식으로 표시합니다. |
| **워커 노드** | 현재/전체 수를 `N/N` 형식으로 표시합니다. |
| **생성 일시** | 클러스터가 생성된 날짜와 시간입니다. |

### 주의사항
- ⚠️ **삭제 중** 상태의 클러스터는 `삭제` 작업이 비활성화됩니다.

> 💡 참고: 상태 컬러는 임계치에 따라 강조됩니다(예: CPU 부하가 높을 때 노란색/빨간색).

---

## 클러스터 생성
### 주요 작업
- `생성`: 필수 항목 검증을 통과하면 활성화됩니다.
- `취소`: 입력을 폐기하고 목록으로 돌아갑니다.

### 1. 기본 정보
- **클러스터 이름**을 입력합니다. 영문 소문자와 숫자를 사용합니다.

### 2. 네트워크 설정
- **가상 네트워크(VPC)**, **서브넷**, **보안 그룹(1개 이상)**을 선택합니다.

### 3. 컨트롤 플레인 설정
- **쿠버네티스 이미지**(OS + Kubernetes 버전)를 선택합니다.  
- **부팅 디스크 크기**(예: 기본값 32–64`GiB`)를 지정합니다.  
- **인스턴스 타입**과 **노드 수**(일반 1개, 고가용성 3개)를 선택합니다.

### 4. CA 인증서 업로드
- **CA 인증서**와 **개인 키** 파일을 업로드합니다(둘 모두 필수).

### 5. Cloud-Init 설정
- **사용자 이름**을 입력합니다. 필요 시 **비밀번호**와 **비밀번호 확인**을 입력합니다.

### 6. 생성/오류 처리
- 생성 성공 시 목록으로 이동하며 새 항목이 “생성 중”으로 표시됩니다. 준비가 완료되면 “실행 중(UP)”으로 전환됩니다.  
- 오류 발생 시 화면 상단에 메시지가 표시됩니다. 값을 수정한 뒤 다시 시도합니다.

#### 입력 필드 유효성
| 필드 | 허용 값 | 검증 규칙 | 비고 |
|------|----------|------------|------|
| 클러스터 이름 | 영문 소문자, 숫자 | 허용 문자 외 입력 시 오류 메시지를 표시합니다. 길이 제한은 시스템 정책을 따릅니다. | 필수 |
| VPC/서브넷 | 프로젝트 내 유효 항목 | 미선택 시 `생성`이 비활성화됩니다. | 필수 |
| 보안 그룹 | 1개 이상 | 0개 선택 시 오류를 표시합니다. | 필수 |
| 이미지 | 제공 목록 중 선택 | 컨트롤 플레인에 적용됩니다. | 필수 |
| 부팅 디스크 크기 | `GiB` 단위 정수 | 최소값/최대값은 시스템 정책을 따릅니다. | 필수 |
| 노드 수 | 1 또는 3 권장 | 최소 1 이상이어야 합니다. | 필수 |
| CA 인증서/개인 키 | 파일 업로드 | 두 파일이 모두 필요합니다. | 필수 |
| Cloud-Init 사용자 | 영문/숫자/특수문자 제한 | 비밀번호 사용 시 확인 값이 일치해야 합니다. | 사용자 필수, 비밀번호 선택 |

---

## 클러스터 상세

### 상단 요약
- **이름**: 클러스터 표시명입니다.
- **ID**: 클러스터 고유 식별자입니다.
- **VPC**: 연결된 네트워크(VPC/서브넷) 정보를 표시합니다.
- **엔드포인트 IP**: API 서버 엔드포인트 `IPv4` 주소입니다.
- **상태**: 활성(UP), 오류, 생성 중, 삭제 중 중 하나를 표시합니다.
- **생성 일시**: 클러스터가 생성된 날짜와 시간입니다.

### 상단 버튼

- `Config 추출`: kubeconfig를 확인·다운로드하여 외부 `kubectl` 연결을 설정합니다.

### 모니터링 탭
#### 주요 작업
- 자동 새로고침: 주기를 선택하거나 새로고침 아이콘으로 즉시 갱신합니다.

#### 주요 지표
- **컨트롤 플레인/워커 상태**를 요약 카드로 표시합니다.
- **CPU 사용률**과 **파드 상태**(Running/Failed)를 시각화합니다.

> 💡 참고: 클러스터 초기화 직후에는 일부 지표가 준비되지 않을 수 있습니다.

### 컴퓨트 탭
#### 주요 작업
- `실행`: NotReady/Pending/오프라인 워커 노드를 재가동합니다.
- `워커 노드 추가`: 클러스터 상태가 UP일 때 활성화됩니다.
- `워커 노드 삭제`: 워커 1대 선택, 컨트롤 플레인 아님, 진행 중 아님일 때 가능합니다.

#### 테이블 컬럼
| 컬럼 | 설명 |
|------|------|
| **역할** | 컨트롤 플레인 또는 워커입니다. |
| **노드 이름** | 노드 표시명입니다. 클릭 시 VM 인스턴스 상세로 이동합니다. |
| **노드 ID** | 노드 고유 식별자입니다. |
| **쿠버네티스 버전** | 노드의 Kubernetes 버전입니다. |
| **IP** | 노드의 `IPv4` 주소입니다. |
| **인스턴스 타입** | 노드의 vCPU/메모리 스펙 유형입니다. |
| **상태** | Ready/NotReady/생성 중 등의 상태를 아이콘과 함께 표시합니다. |
| **생성 일시** | 노드 생성 시간을 표시합니다. |

#### 주의사항
> 💡 참고: 노드 이름을 클릭하면 VM 인스턴스 상세 화면으로 이동하여 CPU, 메모리, 로그를 확인합니다.

### 네트워크 탭
- 정보 제공용 탭으로 **VPC/서브넷/보안 그룹**과 **엔드포인트 IP**를 표시합니다.  
- ⚠️ 주의: 본 탭에서는 네트워크 구성을 수정할 수 없습니다. 변경하려면 클러스터를 재생성하거나 별도 네트워크 메뉴를 사용합니다.

### 스토리지 탭
#### 주요 작업
- 상단 전환: **스토리지 클래스 / PVC**를 전환합니다.
- `스토리지 클래스 생성`: 스토리지 정책을 추가합니다.
- `PVC 생성`: 영구 볼륨 요청을 생성합니다.

#### (스토리지 클래스) 테이블 컬럼
| 컬럼 | 설명 |
|------|------|
| **이름** | 스토리지 클래스 이름입니다. |
| **바인딩 모드** | 바인딩 전략을 표시합니다. |
| **볼륨 확장 허용** | 동적 확장 가능 여부입니다. |

#### (PVC) 테이블 컬럼
| 컬럼 | 설명 |
|------|------|
| **이름** | PVC 이름입니다. |
| **용량** | 요청 용량입니다. |
| **접근 모드** | `ReadOnlyMany` 또는 `ReadWriteMany`입니다. |
| **스토리지 클래스** | 연결된 스토리지 클래스입니다. |
| **상태** | `Pending`/`Bound` 상태를 표시합니다. |

#### 스토리지 클래스 생성
1) 스토리지 탭에서 스토리지 클래스를 선택한 뒤 `스토리지 클래스 생성`을 클릭합니다.  
2) **이름**(소문자/숫자/`-`), **파일 시스템/스토리지 도메인**을 선택합니다.  
3) **반환 정책**(Reclaim Policy)을 선택하고 `생성`을 클릭합니다.  
4) `생성` 버튼을 클릭하면 목록에 새 스토리지 클래스가 추가됩니다.  
> 💡 참고: 반환 정책이 `Delete`인 경우, 관련 PVC 삭제 시 볼륨도 자동 삭제됩니다.  
> 💡 참고: 편집 화면에서는 동일 항목을 수정할 수 있습니다.

#### PVC 생성
1) 스토리지 탭에서 PVC를 선택한 뒤 `PVC 생성`을 클릭합니다.  
2) **이름**, **용량(MiB)**, **스토리지 클래스**, **네임스페이스**, **액세스 모드**를 입력합니다.  
3) `생성` 후 목록에서 상태가 `Pending`에서 `Bound`로 전환되는 것을 확인합니다.  
> 💡 참고: 편집 화면에서는 동일 항목을 수정할 수 있습니다.

### 리소스 탭
- 조회 전용으로 `시스템 파드`/`디플로이먼트`/`서비스`/`데몬셋`/`이벤트`를 제공합니다.
- **시스템 파드**: 이름, 네임스페이스, 상태, 재시작 횟수, 노드 배치를 표시합니다.  
- **디플로이먼트**: 이름, 네임스페이스, 준비/요구 파드 수, 업데이트 일시를 표시합니다.  
- **서비스**: 이름, 타입(ClusterIP/LoadBalancer), 클러스터 IP, 포트, 셀렉터를 표시합니다.  
- **데몬셋**: 이름, 네임스페이스, 현재 파드 수를 표시합니다.  
- **이벤트**: 타입(Normal/Warning), 메시지, 발생 시각, 관련 객체를 시간 순으로 표시합니다. 예: "Successfully provisioned volume".  
- ⚠️ 주의: 본 탭에서는 수정 작업을 제공하지 않습니다. 조치가 필요하면 `kubectl` 등을 사용합니다.

---

## 공통 조건
- 선택형 작업은 **대상 행 선택**이 필요합니다.
- 진행 중 상태(생성/삭제)에서는 일부 작업이 비활성화됩니다.
- 네트워크 구성 변경은 본 화면에서 지원하지 않습니다.

---

## 클러스터 삭제
- 클러스터를 목록에서 선택한 후 `삭제` 버튼을 클릭하여 제거할 수 있습니다.
- 삭제를 진행하면 클러스터와 연동된 리소스(컨트롤 플레인, 워커 노드, 스토리지 설정 등)가 함께 제거됩니다.

### 주의사항
- ⚠️ 주의: “삭제 중” 상태의 클러스터는 다시 삭제할 수 없습니다. 삭제가 완료될 때까지 기다려야 합니다.  
- ⚠️ 주의: 삭제된 클러스터는 복구할 수 없습니다.  
> 💡 참고: 실제 리소스 제거에는 수 분이 소요될 수 있습니다.

---

## 워커 노드 추가
### 주요 작업
- `생성`: 필수 항목 검증을 통과하면 활성화됩니다.
- `취소`: 입력을 폐기하고 목록으로 돌아갑니다.

### 1. 워커 노드 설정
- **쿠버네티스 이미지**(OS + Kubernetes 버전)를 선택합니다.  
- **부팅 디스크 크기**(예: 기본값 32–64`GiB`)를 지정합니다.  
- **인스턴스 타입**과 **노드 수**(1–5개)를 선택합니다.

### 2. Cloud-Init 설정
- **사용자 이름**을 입력합니다. 필요 시 **비밀번호**와 **비밀번호 확인**을 입력합니다.

### 3. 생성/오류 처리
- 생성 성공 시 목록으로 이동하며 새 항목이 “생성 중”으로 표시됩니다. 준비가 완료되면 “실행 중(READY)”으로 전환됩니다.  
- 오류 발생 시 화면 상단에 메시지가 표시됩니다. 값을 수정한 뒤 다시 시도합니다.

#### 입력 필드 유효성
| 필드 | 허용 값 | 검증 규칙 | 비고 |
|------|----------|------------|------|
| 이미지 | 제공 목록 중 선택 | 워커 노드에 적용됩니다. | 필수 |
| 부팅 디스크 크기 | `GiB` 단위 정수 | 최소값/최대값은 시스템 정책을 따릅니다. | 필수 |
| 노드 수 | 1–5 | 최소 1 이상이어야 합니다. | 필수 |
| Cloud-Init 사용자 | 영문/숫자/특수문자 제한 | 비밀번호 사용 시 확인 값이 일치해야 합니다. | 사용자 필수, 비밀번호 선택 |

---

## 워커 노드 삭제
- 컴퓨트 목록에서 워커 노드를 선택한 후 `삭제` 버튼을 클릭하여 제거할 수 있습니다.
- 확인 창이 표시되면 `확인`을 클릭하여 삭제를 진행합니다.

### 주의사항
- ⚠️ 주의: 컨트롤 플레인 노드는 삭제할 수 없습니다.  
> 💡 참고: 삭제 완료 후 노드가 목록에서 사라지고, 클러스터 상태가 자동으로 갱신됩니다.
