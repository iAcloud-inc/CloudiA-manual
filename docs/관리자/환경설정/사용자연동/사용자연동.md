# 사용자연동(LDAP) 사용자 가이드

CloudiA 콘솔의 **사용자연동** 메뉴는 LDAP/AD 등 외부 디렉터리와의 연동 정보를 관리합니다. 이 문서는 **목록**, **상세(매퍼 포함)**, **생성·편집**, **연동 작업**을 안내합니다.

## 한눈에 보기
- **제공자(Provider) 목록**: 연동된 LDAP 제공자의 이름/상태/연결 요약을 확인합니다.
- **제공자 상세**: 연결/검색/동기화 설정 요약과 **매퍼**(속성 매핑 규칙) 관리 탭을 제공합니다.
- **제공자 생성·편집**: 연결, 인증, 검색/동기화, 고급 설정을 단계적으로 설정합니다.

---

## 사용자연동 목록

### 도구 모음과 주요 작업
- `생성`: 새 LDAP 제공자를 등록합니다.
- `수정`: 선택한 제공자의 설정을 변경합니다.
- `삭제`: 선택한 제공자를 제거합니다.
- `활성화` / `비활성`: 선택 제공자의 연동을 켜거나 끕니다.
- `더보기 ▾`
    - `모든 사용자 동기화`: LDAP 전체 사용자를 한 번에 동기화합니다.
    - `변경된 사용자 동기화`: 최근 변경분만 동기화합니다.
    - `연동 해제`: 해당 LDAP의 연결을 일시 해제합니다(Edit Mode가 ‘Unsynced’일 때만 의미가 있음).
    - `가져온 사용자 삭제`: 해당 LDAP로부터 이미 가져온 사용자 계정을 일괄 삭제합니다.

### 테이블 컬럼
| 컬럼         | 설명 |
|------------|---|
| **이름**     | LDAP 제공자 표시명입니다. |
| **활성화**    | 활성/비활성 여부를 표시합니다. |
| **연결 URL** | 연결 대상 호스트:포트 정보입니다. |

### 행 선택 시 주의 사항
- 상태 토글(`활성화`/`비활성`)은 현재 상태에 따라 한쪽만 활성화됩니다.
- `가져온 사용자 삭제`는 복구할 수 없으므로 신중히 실행합니다.

---

## 사용자연동 상세

### 상단 요약
- **연결/인증**: 연결 URL, 바인딩 DN(읽기 전용)
- **검색/매핑**: 사용자 검색 베이스, 고유 ID 속성
- **동기화**: 가져오기 모드, 동기화 방식(전체/변경분), 마지막 동기화 시각

### 하단 탭
- **매퍼**: CloudiA 사용자 속성과 LDAP 속성의 매핑 규칙 목록을 제공합니다.

---

## 사용자연동 생성·편집

### 절차별 안내
1. **일반 옵션**
    - 제공자 이름, 활성화 여부, 우선 순위 등을 지정합니다.
2. **연결 및 인증**
    - `호스트`, `포트`, `바인딩 DN`, 인증 방식(TLS/SSL 등)을 입력합니다.
3. **검색 및 업데이트**
    - 사용자 검색 베이스(DN), LDAP 필터, 사용자/고유 ID 속성 매핑을 설정합니다.
4. **동기화 설정**
    - 가져오기 모드(ON/OFF), 전체/변경분 동기화, 비밀번호 정책 검증 여부를 선택합니다.
5. **고급 설정**
    - 항상 LDAP에서 값 읽기, 기본값/기본값 강제, 바이너리 속성, 배치 크기 등 세부 옵션을 제어합니다.
6. **저장**
    - 연결 테스트 후 저장합니다.

---

## 매퍼 관리

### 도구 모음과 주요 작업
- `매퍼 생성`: 새로운 속성 매핑 규칙을 추가합니다.
- `매퍼 수정`: 선택한 매핑 규칙을 편집합니다.
- `매퍼 삭제`: 선택한 매핑 규칙을 제거합니다(확인 창 표시).

### 매퍼 생성·편집(폼 항목)
- **사용자 속성(CloudiA)**: `username`, `email`, `mobileNumber` 등 지원되는 필드 중 선택
- **LDAP 속성**: 대응되는 LDAP 속성명을 입력(예: `mail`, `telephoneNumber`)
- **읽기 전용**: LDAP→CloudiA 단방향 동기화로 제한
- **항상 LDAP에서 값 읽기**: 조회 시 항상 최신 LDAP 값 사용
- **LDAP 필수 값**: 해당 속성이 LDAP에 반드시 존재해야 함
- **기본값 / 기본값 강제**: LDAP에 값이 없을 때 기본값 사용 및 LDAP에 쓰기
- **이진 속성 여부**: 바이너리 데이터 여부 지정

> 💡 매퍼 변경은 사용자 프로필 동기화에 직접 영향을 줍니다. 변경 전 충돌 여부를 점검하세요.

---

## 입력 필드 유효성

| 필드 | 허용 값 | 검증 규칙 | 비고 |
|---|---|---|---|
| 호스트 | 도메인 또는 `IPv4` | 특수문자 제한 | 필수 |
| 포트 | 1~65535 | 숫자만 | 필수 |
| 바인딩 DN | 문자열 | 형식 검증 | 필수 |
| 검색 베이스 | DN 형식 | 비어 있을 수 없음 | 필수 |
