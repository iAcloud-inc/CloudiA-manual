# 네트워크 접근 제어

네트워크 접근 제어(Network ACL)는 CloudiA에서 가상 네트워크(VPC)의 서브넷 트래픽 흐름을 제어하는 기능입니다. 각 VPC마다 기본적으로 하나의 기본 네트워크 접근 제어가 제공되며, 사용자는 추가로 커스텀 네트워크 접근 제어를 생성하여 서브넷별로 인바운드/아웃바운드 트래픽 정책을 설정할 수 있습니다.

## 네트워크 접근 제어 목록 / 생성 / 상세 / 삭제


### 도구 모음과 주요 기능
* [생성] – 새로운 네트워크 접근 제어를 생성합니다. 클릭 시 네트워크 접근 제어 생성 화면으로 이동합니다.
* [삭제] – 선택한 네트워크 접근 제어를 삭제합니다. 목록에서 하나의 NAC을 선택해야 활성화되며, 클릭 시 삭제 확인 창이 표시됩니다.
* [인바운드 규칙 편집] – 선택한 네트워크 접근 제어의 인바운드 트래픽 허용/차단 규칙을 수정할 수 있습니다. 클릭 시 인바운드 규칙 편집 모달이 열리며, 규칙 추가·삭제·순서 변경이 가능합니다.
* [아웃바운드 규칙 편집] – 선택한 네트워크 접근 제어의 아웃바운드 트래픽 규칙을 수정합니다. 인바운드와 동일한 편집 인터페이스를 사용하며, 수정 후 [규칙 저장] 시 변경 내용이 즉시 반영됩니다.
* [연결된 서브넷 연결] – 선택한 네트워크 접근 제어에 새로운 서브넷을 연결할 수 있습니다. 클릭 시 연결 가능한 서브넷 목록이 표시되며, 서브넷을 선택하고 [확인]을 누르면 NAC에 적용됩니다.

💡 참고: NACL 삭제는 한 번에 하나의 객체만 선택하여 수행할 수 있습니다. 또한 기본 네트워크 접근 제어의 경우 [삭제] 및 [연결된 서브넷 해제] 기능이 비활성화됩니다. 그 외 NACL도 서브넷이 연결된 경우에는 삭제 전에 모든 서브넷 연결을 해제해야 합니다.

---

## 네트워크 접근 제어 목록
### 목록 테이블
네트워크 접근 제어 목록은 다음과 같은 컬럼을 제공합니다
| 컬럼 | 설명 |
|------|------|
| **이름** | 네트워크 접근 제어의 이름입니다. 클릭하면 해당 NACL의 상세 화면으로 이동합니다. |
| **VPC** | NACL이 속한 VPC(가상 네트워크)의 이름입니다. |
| **타입** | NACL의 유형을 표시합니다. **기본(Default)** NACL인지 **커스텀(사용자 생성)** NACL인지 나타냅니다. |
| **인바운드 규칙 / 아웃바운드 규칙 수** | NACL에 설정된 **인바운드 규칙 수**와 **아웃바운드 규칙 수**를 `X / Y` 형태로 표시합니다. |
| **연결된 서브넷 수** | 현재 해당 NACL에 **연결된 서브넷의 개수**입니다. |
| **설명** | NACL에 대한 설명 텍스트입니다. |
| **생성 일시** | NACL이 생성된 **날짜와 시간**입니다. |

---

## 네트워크 접근 제어 생성
[생성] 버튼을 통해 NACL 생성 페이지로 이동하면, 새로운 네트워크 접근 제어를 정의할 수 있습니다. 생성 페이지에서는 NACL의 기본 속성을 입력하고 [확인] 버튼으로 저장합니다 (취소할 경우 [취소] 버튼으로 목록 화면으로 돌아갑니다). 필드별 입력 사항은 다음과 같습니다.
| 필드 | 허용 값 및 범위 | 검증 규칙 | 비고 |
|------|----------------|------------|------|
| **이름** | 영문 대소문자, 숫자, 하이픈(-), 밑줄(_) 문자 사용 가능. 최대 20자까지 입력 가능. | 빈 값 없이 입력해야 하며, 허용된 문자만 사용할 수 있습니다. | 필수 항목 |
| **VPC** | 현재 프로젝트에 존재하는 **VPC 목록** 중 하나 선택 | 하나를 반드시 선택해야 합니다. | 필수 항목 |
| **설명** | 한글/영문 및 숫자 등 텍스트, **최대 200자**까지 입력 가능 | 특별한 형식 제한 없음. | 선택 사항 |

💡 참고: NACL 이름은 목록 내에서 고유해야 합니다. 이름 입력란에 허용되지 않은 문자를 넣거나 글자 수를 초과하면 오류 메시지가 표시됩니다.
필수 필드를 모두 올바르게 입력하면 [확인] 버튼이 활성화되며, 클릭 시 NACL가 생성되고 목록 화면으로 돌아갑니다.

---

## 네트워크 접근 제어 상세
NACL를 선택하면 해당 상세 화면으로 이동합니다. 상세 화면 상단에는 해당 NACL의 주요 정보가 요약되어 표시됩니다
* **이름**: NACL의 이름입니다.
* **VPC**: NACL가 속한 VPC 이름입니다.
* **설명**: NACL에 대한 설명입니다. 입력된 값이 없다면 -로 표시됩니다.
* **인바운드 규칙 수**: 현재 설정된 인바운드 규칙의 개수입니다 (최대 20개).
* **아웃바운드 규칙 수**: 현재 설정된 아웃바운드 규칙의 개수입니다 (최대 20개).
* **생성 일시**: NACL가 생성된 날짜와 시간입니다.
* **타입**: NACL 유형 (기본 또는 커스텀)을 표시합니다.
* **연결된 서브넷 수**: 이 NACL에 연결되어 있는 서브넷의 개수입니다.
  
상세 화면 하단에서는 인바운드 규칙, 아웃바운드 규칙, 연결된 서브넷 세 가지 탭으로 세부 기능을 제공합니다. 각 탭을 선택하여 해당 정보를 확인하고 작업을 수행할 수 있습니다.

### 인바운드 규칙 탭
* 인바운드 규칙 탭에서는 선택한 NAC에 적용되는 들어오는 트래픽 규칙 목록을 확인할 수 있습니다.
* 규칙들은 우선순위 번호 순으로 나열되며, 마지막에는 모든 트래픽을 거부하는 기본 규칙이 존재합니다.
* 사용자는 [편집] 버튼을 눌러 인바운드 규칙을 추가, 수정할 수 있습니다.
* 규칙 편집 모드에서는 새로운 규칙을 추가하거나 기존 규칙을 제거하고 순서를 변경할 수 있으며, 완료 후 [규칙 저장] 버튼을 눌러 변경사항을 적용합니다.
* 인바운드 규칙은 최대 20개까지 설정 가능하며, 마지막 `*` 규칙은 모든 미허용 트래픽을 차단하는 고정 규칙으로 편집할 수 없습니다.

인바운드 규칙 테이블의 컬럼 구성은 다음과 같습니다
| 컬럼 | 설명 |
|------|------|
| **규칙 번호** | 규칙의 **평가 순서 번호**입니다. 숫자가 작을수록 우선 적용되며, `*` 표시는 모든 남은 트래픽을 차단하는 **기본 규칙**을 의미합니다. |
| **프로토콜** | 규칙이 적용될 **네트워크 프로토콜**입니다 (예: TCP, UDP, ICMP 등). |
| **소스 CIDR** | 해당 규칙이 적용될 **소스 IP 주소 범위(CIDR)** 입니다. 이 범위에 해당하는 IP로부터 들어오는 트래픽에 규칙이 적용됩니다. |
| **포트** | 규칙이 적용될 **포트 번호 또는 포트 범위**입니다. 단일 포트 번호 또는 `X:Y` 형태의 범위를 지정하며, `ALL`은 모든 포트를 의미합니다. |
| **허용/거부** | 해당 트래픽을 **허용**할지 **거부**할지에 대한 동작이 표시됩니다. 규칙에 따라 **허용(Allow)** 또는 **거부(Deny)** 로 설정됩니다. |
| **설명** | 규칙에 대한 **설명**입니다. 관리자 참고용으로 입력된 내용이며, 비어 있을 경우 표시되지 않습니다. |

### 아웃바운드 규칙 탭
* 아웃바운드 규칙 탭에서는 해당 NACL이 적용하는 나가는 트래픽 규칙 목록을 제공합니다.
* 기본적인 작동 방식과 UI 구성은 인바운드 규칙 탭과 동일하며, [편집] 버튼을 통해 아웃바운드 규칙을 추가/수정할 수 있습니다.
* 아웃바운드 규칙 역시 최대 20개까지이며, 마지막 `*` 기본 차단 규칙이 존재합니다.
* 아웃바운드 규칙 테이블의 컬럼은 인바운드 규칙과 유사하며, CIDR 항목만 대상 CIDR을 사용한다는 점이 다릅니다

| 컬럼 | 설명 |
|------|------|
| **규칙 번호** | 규칙의 평가 순서 번호입니다. `*` 표시는 모든 미처리 트래픽을 차단하는 **기본 규칙**입니다. |
| **프로토콜** | 규칙이 적용되는 **네트워크 프로토콜**입니다 (TCP, UDP 등). |
| **대상 CIDR** | 해당 규칙이 적용될 **대상 IP 주소 범위(CIDR)** 입니다. 이 범위에 해당하는 IP로 향하는 트래픽에 규칙이 적용됩니다. |
| **포트** | 규칙이 적용되는 **포트 또는 포트 범위**입니다. `ALL`은 모든 포트를 의미합니다. |
| **허용/거부** | 트래픽 허용 또는 거부 동작이 표시됩니다 (**Allow** 또는 **Deny**). |
| **설명** | 규칙에 대한 **설명**입니다. (입력된 경우에만 표시) |

💡 참고: 인바운드/아웃바운드 규칙 편집 화면에서 [규칙 추가] 버튼을 통해 새 규칙 행을 추가할 수 있으며, 규칙의 순서를 드래그하여 변경할 수 있습니다. 규칙 순서는 위에서 아래로 평가되므로, 보다 엄격한 조건을 상위에 둘 수 있도록 관리해야 합니다. 또한 휴지통 아이콘을 눌러 불필요한 규칙을 제거할 수 있습니다. 규칙 수정 작업 후 **[규칙 저장]** 을 누르면 변경사항이 NACL에 적용됩니다.

### 연결된 서브넷 탭
* 연결된 서브넷 탭에서는 현재 이 NACL가 적용되고 있는 서브넷 목록을 보여줍니다.
* NACL에 연결된 서브넷들은 이 NACL의 인바운드/아웃바운드 규칙이 적용되며, 기본 NACL의 경우 VPC 내 모든 서브넷이 여기에 포함될 수 있습니다.
* 화면 상단의 [연결] 버튼을 통해 아직 이 NAC에 연결되지 않은 서브넷을 새로 연결할 수 있고, [해제] 버튼을 통해 선택한 서브넷들을 NACL에서 분리할 수 있습니다.
* **서브넷 연결**: [연결] 버튼을 클릭하면 서브넷 선택 창이 나타납니다. 해당 NACL에 현재 연결되어 있지 않은 서브넷들이 드롭다운 목록으로 제공되며, 하나를 선택 후 확인하면 NACL에 연결됩니다. 연결된 서브넷 리스트에 추가된 것을 확인할 수 있습니다.
* **서브넷 해제**: NACL에 연결된 서브넷을 목록에서 선택한 뒤 [해제] 버튼을 클릭하면 확인 대화창이 나타납니다. 확인 시 선택한 서브넷들이 NACL에서 연결 해제되고 목록에서 제거됩니다. (해제된 서브넷은 기본 NACL의 규칙이 다시 적용됩니다.)

  
연결된 서브넷 테이블의 컬럼 구성은 다음과 같습니다
| 컬럼 | 설명 |
|------|------|
| **이름** | 서브넷의 **이름**입니다. |
| **VPC** | 서브넷이 속한 **가상 네트워크(VPC)** 이름입니다. |
| **타입** | 서브넷의 **유형**입니다. **퍼블릭 서브넷**인지 **프라이빗 서브넷**인지 표시됩니다. |
| **CIDR** | 서브넷의 IP 주소 **주소 범위(CIDR)**입니다. |
| **기본 게이트웨이** | 서브넷의 **기본 게이트웨이** IP 주소입니다. |
| **사용 IP / 전체 IP** | 해당 서브넷에서 **사용 중인 IP 주소 개수 / 전체 IP 개수**를 나타냅니다. |
| **설명** | 서브넷에 대한 설명입니다. |
| **생성 일시** | 서브넷이 생성된 시간입니다. |

⚠️ 주의: 기본 네트워크 접근 제어의 경우 서브넷 [해제] 기능이 제공되지 않습니다. 기본 NACL는 VPC 생성 시 자동으로 연결되며 삭제할 수도 없으므로, 특정 서브넷에 별도의 NACL를 적용하려면 해당 서브넷을 원하는 커스텀 NACL에 **[연결]** 하여 기본 NACL 대신 적용하도록 해야 합니다. 한편, 커스텀 NACL를 삭제하기 위해서는 연결된 모든 서브넷을 먼저 해제해야 합니다. 서브넷이 하나라도 연결된 상태의 NACL는 삭제할 수 없습니다.

---

## 네트워크 접근 제어 삭제
한 번 삭제된 NACL은 복구할 수 없으며, 동일한 이름으로 다시 생성하더라도 이전 규칙이나 연결 정보는 복원되지 않습니다. CloudiA 시스템 구조상 각 VPC는 반드시 하나의 기본 NACL을 유지해야 하므로, 기본 NACL 삭제는 허용되지 않습니다.

* **기본 NACL**: VPC 생성 시 자동으로 생성되는 **기본 NACL**은 삭제할 수 없습니다. 해당 NACL은 항상 존재하며, VPC 내 서브넷이 연결되지 않더라도 유지됩니다.
* **커스텀 NACL**: **기본 NACL이 아니고**, 연결된 서브넷이 없는 상태에서만 삭제할 수 있습니다. 즉, 사용자가 직접 생성한 NACL 중에서 서브넷 연결이 해제된 경우에 한해 삭제 가능합니다.
* **연결된 서브넷**: NACL에 하나 이상의 서브넷이 연결되어 있는 경우 삭제할 수 없습니다. 삭제 전 반드시 모든 서브넷 연결을 해제해야 합니다. 서브넷 연결을 해제하면 해당 서브넷은 자동으로 **기본 NACL**로 재연결됩니다.
