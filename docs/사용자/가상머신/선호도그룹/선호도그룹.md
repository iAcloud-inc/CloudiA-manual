# CloudiA 선호도 그룹 사용자 가이드

## 선호도 그룹 목록
**선호도 그룹** 페이지에서는 현재 프로젝트에서 생성된 모든 선호도 그룹을 확인하고 신규 그룹을 추가하거나 기존 그룹을 관리할 수 있습니다. 목록 화면에는 각 선호도 그룹의 주요 정보가 표 형태로 제공됩니다.

### 도구 모음과 주요 작업
- **`생성`** – 새로운 선호도 그룹을 추가합니다. 버튼을 클릭하면 **선호도 그룹 생성** 화면으로 이동합니다.  
- **`편집`** – 선택된 선호도 그룹을 편집합니다. 선호도 그룹을 **하나만 선택한 경우에만 활성화**되며, 클릭 시 **선호도 그룹 편집** 화면으로 이동합니다.  
- **`삭제`** – 선택된 선호도 그룹을 삭제합니다. 선호도 그룹을 한 개 이상 선택하면 활성화되며, 클릭 시 확인 팝업(“선호도 그룹 삭제하시겠습니까?”)이 나타납니다. 삭제를 확정하면 해당 그룹이 목록에서 제거됩니다.  

> 💡 참고: 동시에 여러 선호도 그룹을 선택하여 편집할 수는 없습니다. 편집은 **단일 그룹 선택 시**에만 가능합니다. 또한 선호도 그룹 삭제 시 해당 그룹에 설정된 규칙이 더 이상 적용되지 않으므로, 필요할 경우 **삭제 전에 다른 그룹으로 가상머신을 재구성**해야 합니다.

### 테이블 컬럼
선호도 그룹 목록에는 다음과 같은 컬럼들이 표시됩니다:

| 컬럼 | 설명 |
|------|------|
| **이름** | 선호도 그룹의 이름입니다. 클릭하면 해당 **상세** 화면으로 이동합니다. |
| **ID** | 선호도 그룹의 고유 식별자(ID)입니다. |
| **활성화 여부** | 현재 선호도 그룹이 활성 상태인지 표시합니다. **활성화**인 경우 규칙이 적용 중이며, **비활성화**인 경우 규칙이 적용되지 않습니다. |
| **설명** | 선호도 그룹에 대한 설명 문자입니다. 생성 시 입력한 비고 내용을 보여줍니다. |
| **생성 일시** | 선호도 그룹이 생성된 날짜와 시간입니다. |

### 주의사항
- 선호도 그룹이 **비활성화** 상태이면 그룹에 설정된 모든 선호도 규칙이 적용되지 않습니다. 필요한 경우 목록에서 해당 그룹을 선택하고 `편집`하여 **활성화**로 전환할 수 있습니다.  
- 선호도 그룹을 삭제해도 그룹에 속한 가상머신이나 물리 머신 자체에는 영향을 주지 않지만, 해당 가상머신들은 더 이상 선호도 배치 규칙의 영향을 받지 않게 됩니다.

## 선호도 그룹 상세
어떤 선호도 그룹을 선택하면 해당 그룹의 **상세 화면**이 표시됩니다. 이 화면에서는 그룹의 기본 정보와 설정된 선호도 규칙을 확인하고, 그룹에 포함된 대상(가상머신 및 물리 머신) 목록을 볼 수 있습니다.

### 상단 요약
상세 화면 상단에는 선택한 선호도 그룹의 요약 정보가 실제 UI 구성 순서대로 정리되어 있습니다:

- **이름** – 선호도 그룹의 이름입니다.  
- **ID** – 그룹의 고유 ID입니다.  
- **활성화 여부** – 그룹의 활성화 상태를 표시합니다 (활성화 / 비활성화).  
- **설명** – 그룹에 대한 설명 텍스트입니다.  
- **가상머신 선호도** – 그룹 내 **가상머신들 간**의 선호도 규칙입니다. *“선호도”*인 경우 그룹에 속한 가상머신들을 **가능한 같은 호스트에 배치**하고, *“반선호도”*인 경우 **서로 다른 호스트에 분산 배치**합니다. *“사용 안함”*으로 표시되면 가상머신 간 선호도 규칙을 적용하지 않습니다.  
- **가상머신 강제성** – VM 선호도 규칙의 **강제 적용 여부**입니다. *“강제”*인 경우 규칙을 만족하지 못하면 해당 가상머신을 실행하지 않을 정도로 **엄격히 적용**하며, *“비강제”*인 경우 규칙을 따르는 것이 **권고**되지만 충족하지 못해도 가상머신을 실행합니다. (선호도 규칙이 *사용 안함*인 경우 **강제성**도 적용되지 않습니다.)  
- **물리 머신 선호도** – 그룹에 포함된 **물리 머신(호스트)**과 가상머신 간의 선호도 규칙입니다. *“선호도”*이면 그룹의 가상머신들을 **지정된 물리 머신에서 실행하도록 선호**하며, *“반선호도”*이면 해당 **물리 머신들을 피해서 실행**합니다. *“사용 안함”*인 경우 특정 호스트에 대한 선호도 규칙을 적용하지 않습니다.  
- **물리 머신 강제성** – 호스트 선호도 규칙의 강제 적용 여부입니다. *“강제”*이면 지정된 규칙을 **반드시 준수**하도록 하고, *“비강제”*이면 규칙을 가능하면 따르되 상황에 따라 예외를 허용합니다.  
- **생성 일시** – 선호도 그룹이 생성된 시간입니다.

### 하단 탭: 가상머신 / 물리 머신
상세 정보 하단에는 두 개의 탭이 제공됩니다. **`가상머신`** 탭과 **`물리 머신`** 탭을 전환하여 해당 그룹에 속한 대상 목록을 확인할 수 있습니다. 각 탭에서는 그룹에 속한 가상머신들과 호스트들의 정보를 표로 제공합니다.

#### 가상머신 탭
이 탭에서는 선호도 그룹에 포함된 **가상머신 목록**을 보여줍니다. 그룹에 속한 모든 VM의 주요 정보가 표로 나열되며, 한 페이지에 5개의 항목씩 표시됩니다. 

- **멤버 편집:** 가상머신 목록 우측 상단의 `편집` 버튼을 클릭하면 **가상머신 대상 수정** 화면으로 이동하여 이 그룹의 VM 구성을 변경할 수 있습니다. 새로운 VM을 그룹에 추가하거나 기존 VM을 제거한 뒤 **저장**하면 그룹 구성원이 업데이트됩니다.

가상머신 목록에 표시되는 컬럼은 다음과 같습니다:

| 컬럼 | 설명 |
|------|------|
| **이름** | 가상머신 인스턴스의 이름입니다. |
| **ID** | 인스턴스의 고유 ID입니다. |
| **생성 방식** | 해당 VM의 생성 방식입니다. |
| **IP 주소** | VM에 할당된 기본 IP 주소입니다. |
| **상태** | 현재 인스턴스의 상태를 나타냅니다. 상태에 따라 컬러 배지로 표시됩니다. |
| **vCPU** | VM에 할당된 가상 CPU 코어 개수입니다. |
| **메모리** | VM에 할당된 메모리 용량입니다 (단위: GiB). |
| **생성 일시** | 해당 가상머신이 생성된 날짜와 시간입니다. |

> 💡 참고: *가상머신 대상 수정* 화면에서는 현재 프로젝트의 모든 가상머신 목록에서 선택하여 이 그룹에 추가할 수 있습니다. `추가` 버튼을 누르면 VM 선택 팝업이 열리며, 여러 인스턴스를 한 번에 선택 가능합니다. 이미 그룹에 속한 VM은 목록에서 체크되어 표시되며, **삭제** 버튼을 눌러 선택된 VM을 그룹에서 제외할 수도 있습니다. 변경 사항을 저장하면 선호도 그룹의 VM 구성이 즉시 반영됩니다.

#### 물리 머신 탭
이 탭에서는 선호도 그룹에 포함된 **호스트(물리 머신) 목록**을 제공합니다. 해당 그룹이 적용될 대상으로 지정된 물리 머신들의 정보가 표로 나열됩니다 (한 페이지당 최대 5개 항목).

- **멤버 편집:** 물리 머신 목록의 `편집` 버튼을 클릭하면 **물리 머신 대상 수정** 화면으로 이동합니다. 여기서 이 그룹에 포함시킬 호스트를 선택하거나 제외할 수 있습니다. **저장**을 완료하면 그룹의 호스트 목록이 갱신됩니다.

물리 머신 목록의 컬럼은 다음과 같습니다:

| 컬럼 | 설명 |
|------|------|
| **이름** | 물리 머신(호스트)의 이름입니다. |
| **ID** | 호스트의 고유 ID입니다. |
| **생성 일시** | 호스트가 시스템에 등록된 시간입니다. |

> 💡 참고: 호스트 대상 수정 화면에서는 현재 시스템에 등록된 모든 **물리 머신 목록**이 제공됩니다. 사용자는 이 중 원하는 호스트를 선택하여 그룹에 추가하거나, 기존에 그룹에 포함된 호스트의 선택을 해제하여 제외할 수 있습니다. 

## 선호도 그룹 생성·편집
새로운 선호도 그룹을 생성하거나 기존 그룹을 편집할 때는 **선호도 그룹 생성/편집** 화면을 사용합니다. 생성과 편집 화면의 구성과 입력 항목은 동일하며, 편집 모드에서는 선택한 그룹의 현재 설정 값들이 미리 채워져 있습니다. 여기에서는 선호도 그룹을 설정하는 단계별 절차와 입력 항목에 대해 설명합니다.

> ⚙️ 공통 조건: 선호도 그룹 생성 및 편집 작업을 수행하려면 프로젝트에 대해 해당 작업 권한이 있어야 합니다. 또한 **편집 모드에서는** 이미 존재하는 그룹의 **이름**을 변경할 경우 다른 그룹과 중복되지 않도록 해야 합니다.

#### 1. 기본 정보
- **이름:** 선호도 그룹의 이름을 입력합니다. 프로젝트 내에서 고유하게 정하는 것이 좋습니다. *예:* `database-affinity-group`  
- **활성화 여부:** 그룹을 활성화할지 여부를 설정합니다. **활성화(`활성화`)**로 두면 그룹 생성 후 즉시 규칙을 적용하며, **비활성화(`비활성화`)**로 선택하면 일단 규칙을 적용하지 않은 상태로 그룹을 만들 수 있습니다. (추후 상세 화면 등에서 활성화 전환 가능)  
- **설명:** 선호도 그룹에 대한 부가 설명이나 메모를 입력합니다. 이 필드는 선택 사항이며, 입력하지 않아도 그룹 생성이 가능합니다.  

#### 2. 가상머신 선호도 규칙
- **가상머신 선호도:** 그룹 내 가상머신들 간의 배치 선호도를 선택합니다. *`선호도`*를 선택하면 **같은 호스트에 묶어 배치**하고, *`반선호도`*를 선택하면 **서로 다른 호스트에 분산 배치**합니다. *`사용 안함`*을 선택하면 VM 간 선호도 규칙을 적용하지 않습니다.  
- **가상머신 강제성:** 위에서 선택한 VM 선호도 규칙을 **엄격하게 적용할지** 여부입니다. *`강제`*를 선택하면 해당 규칙을 만족하지 않으면 새로운 가상머신을 **실행하지 않을 정도로 강제**하며, *`비강제`*를 선택하면 규칙을 만족하지 못하더라도 일단 **가상머신을 실행은 허용**합니다. (만약 VM 선호도를 *사용 안함*으로 했다면 강제성 옵션은 비활성화됩니다.)  
- *예:* “가상머신 선호도: 반선호도”와 “가상머신 강제성: 강제”로 설정하면, 이 그룹에 속한 VM들은 서로 다른 호스트에 반드시 분산 배치됩니다. 하나의 호스트에 이미 그룹 내 VM이 실행 중이라면 추가 VM은 해당 호스트에 **실행되지 않습니다.**

#### 3. 물리 머신 선호도 규칙
- **물리 머신 선호도:** 그룹에 지정할 **호스트들에 대한 선호도 규칙**입니다. *`선호도`*를 선택하면 그룹 내 VM들이 설정된 호스트들에서 **우선 실행**되도록 하고, *`반선호도`*를 선택하면 설정한 호스트들에서는 **가능한 실행되지 않도록** 합니다. *`사용 안함`*은 특정 호스트에 대한 규칙을 사용하지 않는다는 의미입니다.  
- **물리 머신 강제성:** 위의 호스트 선호도 규칙의 강제 여부를 선택합니다. *`강제`*인 경우 규칙을 지키지 못하면 VM을 실행하지 않을 정도로 적용하며, *`비강제`*인 경우 규칙을 지키는 것을 권고하지만 필요 시 무시할 수 있습니다. (호스트 선호도가 *사용 안함*인 경우 이 옵션은 비활성화됩니다.)  
- *예:* “물리 머신 선호도: 선호도”와 “물리 머신 강제성: 비강제”로 설정하고 호스트 A를 대상에 추가하면, 그룹 내 VM들은 **가능한 호스트 A에서 실행**되도록 스케줄링되지만, 호스트 A가 가득 찬 경우 등에는 다른 호스트에도 실행될 수 있습니다.

#### 4. 선호도 그룹 대상 추가
- **가상머신 선택:** 그룹에 포함할 가상머신을 선택합니다. **`추가`** 버튼을 클릭하면 현재 프로젝트의 가상머신 목록 팝업이 열립니다. 여기서 하나 이상의 VM을 선택하여 그룹에 추가할 수 있습니다. 선택한 가상머신들은 목록에 표시되며, 잘못 선택한 VM이 있다면 체크 후 **`삭제`** 버튼을 눌러 목록에서 제외합니다. (이 단계는 선택 사항이며, 그룹을 생성할 때 **가상머신을 바로 추가하지 않고 비워둘 수도 있습니다.**)  
- **물리 머신 선택:** 그룹에 적용할 물리 머신(호스트)을 선택합니다. **`추가`** 버튼을 눌러 호스트 선택 팝업을 열고, 이 그룹의 선호도 규칙 대상이 될 호스트들을 선택합니다. VM 선택과 마찬가지로, 선택된 호스트들은 리스트로 표시되며 체크 후 **`삭제`**를 눌러 제외할 수 있습니다. (호스트도 선택하지 않고 그룹을 생성할 수 있습니다. 호스트를 지정하지 않으면 해당 선호도 규칙은 의미가 없게 됩니다.)  

#### 5. 설정 완료
모든 필드와 설정을 지정했다면 화면 하단의 **`생성`** 버튼을 클릭하여 선호도 그룹을 생성합니다. (편집 모드에서는 **`편집`** 버튼이 표시됩니다.) 생성/편집 버튼은 필수 입력값이 누락되었거나 잘못된 경우 비활성화됩니다. **취소**하려면 **`취소`** 버튼을 눌러 이전 화면으로 돌아갈 수 있습니다.

> ⚠️ 주의: 선호도 그룹을 생성한 후 **활성화되어 있는 경우**, **새로 실행하는 가상머신은 해당 그룹의 규칙 영향을 받게 됩니다.** 필요한 가상머신이나 호스트를 빠뜨리지 않고 추가했는지 생성 전에 다시 한 번 확인하세요. 생성 후에도 상세 화면에서 대상을 추가하거나 제거할 수 있으며, 그룹을 **비활성화**하여 일시적으로 규칙을 적용하지 않을 수도 있습니다.

### 입력 필드 유효성
선호도 그룹 생성·편집 시 입력해야 하는 주요 필드에 대한 입력값 제한과 검증 규칙은 다음과 같습니다:

| 필드 | 허용 값 | 검증 규칙 | 비고 |
|------|----------|------------|------|
| **이름** | 영문 대소문자 및 숫자, 최대 **20자** | **필수 입력**. 첫 글자는 숫자나 특수문자(`-` 등) 불가. 공백 및 기타 특수문자 사용 불가. | 중복 이름 방지 권장 |
| **설명** | 모든 문자, 최대 **200자** | 선택 입력. 최대 길이 초과 시 입력 제한 | 메모 용도 |

