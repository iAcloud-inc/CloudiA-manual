# CloudiA 선호도 그룹 사용자 가이드

**선호도 그룹**은 여러 가상 머신의 배치 위치를 제어하기 위한 도구입니다. 

선호도 그룹을 사용하여 지정한 가상머신들끼리는 가능하면 같은 물리 호스트에 함께 배치하거나(**선호도**), 혹은 반대로 서로 다른 호스트에 배치되도록(**반선호도**) 규칙을 정할 수 있습니다.

또한 호스트 단위의 선호도 설정을 통해 특정 가상머신들이 지정된 호스트에서만 실행되거나 혹은 피하도록 설정할 수도 있습니다.

이를 통해 서비스의 고가용성 확보나 성능 최적화 등의 목적에 맞게 유연한 배치 전략을 구성할 수 있습니다.

## 선호도 그룹 유형 및 규칙
선호도 그룹을 생성할 때 다음과 같은 네 가지 배치 규칙을 설정할 수 있습니다:

| **규칙 종류** | **설명** |
| --- | --- |
| 가상 머신 간 **선호도** | 그룹 내 가상 머신들을 **같은 호스트**에 가능하면 함께 배치하는 규칙입니다. |
| 가상 머신 간 **반선호도** | 그룹 내 가상 머신들을 **서로 다른 호스트**에 가능하면 분산 배치하는 규칙입니다. |
| 호스트 **선호도** | 그룹에 추가된 **특정 호스트(들)**에 그룹 내 가상 머신들을 배치하려는 규칙입니다. |
| 호스트 **반선호도** | 그룹에 추가된 **특정 호스트(들)**를 피하여 그룹 내 가상 머신들을 배치하려는 규칙입니다. |

각 규칙은 **엄격 적용** 여부를 선택할 수 있습니다.

엄격 적용을 활성화하면 해당 규칙을 반드시 준수하도록 강제하며, 규칙을 만족시킬 수 없는 경우 해당 가상머신의 배치나 실행이 이루어지지 않습니다.

엄격 적용을 해제하면 해당 규칙은 **권고 사항**으로 간주되어, 시스템이 가능하면 규칙을 따르지만 자원 상황에 따라 필요시 규칙을 무시하고 가상머신을 배치할 수 있습니다.

## 선호도 그룹 생성
1. CloudiA 콘솔에서 관련 **프로젝트**를 선택한 후 좌측 메뉴에서 **선호도 그룹** 페이지로 이동합니다.
2. **선호도 그룹 생성** 버튼을 클릭합니다.
3. 선호도 그룹 생성 양식에서 다음 정보를 입력합니다:
   - **이름**: 선호도 그룹의 이름을 입력합니다. (프로젝트 내에서 중복 불가)
   - **설명**: 선호도 그룹에 대한 설명을 입력합니다. (선택 사항)
   - **가상 머신 간 규칙**: 배치 규칙으로 **선호도** 또는 **반선호도**를 선택합니다. (그룹 내 가상머신들을 함께 배치할지 분산 배치할지 결정)
   - **엄격 적용 (가상머신)**: 가상머신 간 규칙에 대해 엄격 적용을 할지 여부를 체크합니다.
   - **호스트 대상 규칙**: 호스트에 대한 배치 규칙으로 **선호도** 또는 **반선호도**를 선택합니다. (특정 호스트에 배치할지 또는 피할지 결정; 필요 시 선택)
   - **엄격 적용 (호스트)**: 호스트 규칙에 대해 엄격 적용을 할지 여부를 체크합니다.
4. 입력을 완료한 후 **생성** 또는 **확인** 버튼을 클릭하여 선호도 그룹을 생성합니다.
5. 선호도 그룹이 성공적으로 생성되면 선호도 그룹 목록에 새 그룹이 표시됩니다. 생성 직후에는 그룹에 대상이 추가되어 있지 않은 상태입니다.

> **참고:** 선호도 그룹을 만든 이후에는 반드시 해당 그룹에 가상머신이나 호스트 **대상**을 추가해야 규칙이 실제로 적용됩니다. 대상이 추가되지 않은 선호도 그룹은 배치에 아무런 영향도 주지 않습니다.

## 선호도 그룹 대상 추가
1. 생성된 선호도 그룹의 상세 화면으로 이동합니다. (선호도 그룹 목록에서 해당 그룹을 클릭)
2. **선호도 그룹 대상 추가** 기능을 사용하여 그룹에 가상머신 또는 호스트를 추가합니다. 
   - **가상 머신 추가**: 그룹에 포함시킬 가상머신들을 선택하여 추가합니다. 가상머신 간 선호도/반선호도 규칙을 활용하려면 두 개 이상의 가상머신을 그룹에 포함시켜야 효과가 나타납니다.
   - **호스트 추가**: 그룹에 적용할 호스트를 선택하여 추가합니다. 호스트 선호도/반선호도 규칙을 사용하려면 그룹에 한 개 이상의 호스트와 한 개 이상의 가상머신이 모두 포함되어야 합니다.
3. 대상 선택을 완료한 후 **추가** 또는 **저장**을 눌러 그룹에 반영합니다. 그룹 상세 화면에서 현재 그룹에 속한 가상머신 목록과 호스트 목록을 확인할 수 있습니다.

> **참고:** 하나의 가상머신을 여러 선호도 그룹에 추가할 수 있지만, **상충되는 규칙**을 가진 두 그룹에 동시에 속할 수는 없습니다. 예를 들어, 동일한 가상머신 집합을 대상으로 한 **선호도 그룹**과 **반선호도 그룹**을 중복으로 생성할 수 없습니다. CloudiA는 충돌하는 선호도 설정이 감지되면 오류를 표시하고 이러한 구성을 방지합니다.

## 선호도 그룹 편집
- **편집**: 기존에 생성된 선호도 그룹의 설정을 변경하려면 그룹 상세 화면에서 **편집** 기능을 사용합니다. 이름이나 설명을 수정하고, 필요에 따라 선호도 규칙(및 엄격 적용 옵션)을 변경할 수 있습니다. 또한 그룹에 속한 **대상**(가상머신/호스트)도 추가하거나 제거할 수 있습니다. 변경사항을 저장하면 해당 그룹의 배치 규칙이 즉시 업데이트되어 새로운 설정이 적용됩니다.

## 선호도 그룹 삭제
- **삭제**: 선호도 그룹이 더 이상 필요 없거나 사용되지 않는 경우 그룹을 **삭제**할 수 있습니다. 삭제는 그룹 상세 화면 또는 그룹 목록에서 수행하며, 삭제 확인 후 그룹이 제거됩니다. 그룹을 삭제해도 그룹에 속해 있던 가상머신들은 즉시 종료되거나 이동하지는 않지만, 향후 해당 가상머신들의 배치에는 더 이상 해당 그룹의 규칙이 적용되지 않습니다.
