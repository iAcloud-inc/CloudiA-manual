# 인스턴스 사용자 가이드

## 인스턴스 목록 / 상세 / 생성·편집

### 도구 모음과 주요 작업
- `생성`: 새 인스턴스를 만듭니다. (항상 활성화)
- `편집`: 선택한 **1개** 인스턴스를 수정합니다. 선택 시 활성화되며 상태 제약이 있을 수 있습니다.
- `삭제`: 선택한 **1개** 인스턴스를 삭제합니다. 일반적으로 **전원이 꺼진(정지됨)** 인스턴스에서만 활성화됩니다.
- `더보기`
  - `스냅샷 생성`: 인스턴스 상태를 스냅샷으로 저장합니다. 진행 중 작업이 없고 `실행 중` 또는 `정지됨`일 때 가능.
  - `라이브 마이그레이션`: `실행 중` 인스턴스를 중단 없이 다른 호스트로 이동합니다.
- 전원/상태 제어 (단일 선택 시 표시/활성화)
  - `실행`: 전원을 켭니다. (`정지됨` 등에서 활성)
  - `종료`: 정상 종료합니다. (`실행 중`에서 활성)
  - `재부팅`: 인스턴스를 재시작합니다. (`실행 중`에서 활성)

> 💡 **공통 조건:** 모든 작업은 **한 번에 1개 인스턴스 선택** 기준으로 동작합니다. 상태에 따라 버튼이 자동으로 비활성화될 수 있습니다.

### 테이블 컬럼
| 컬럼 | 설명 |
|------|------|
| **이름** | 인스턴스 표시명입니다. 클릭 시 상세 화면으로 이동합니다. |
| **상태** | `실행 중`, `정지됨`, `생성 중` 등 현재 상태를 배지로 표시합니다. |
| **vCPU** | 할당된 vCPU 개수입니다. |
| **메모리** | 할당된 메모리(`GiB`)입니다. |
| **IP 주소** | NIC에 할당된 IPv4 주소를 표시합니다. 다중 NIC인 경우 쉼표로 구분됩니다. |
| **생성 일시** | 인스턴스가 생성된 일시입니다. |

### 주의사항
- 일부 인스턴스는 정책/소유권에 따라 `삭제`, `전원 제어`가 제한될 수 있습니다. UI에서 해당 작업은 비활성화되거나 안내 메시지가 표시됩니다.

---

## 상세 화면

### 상단 요약
- **이름 / 상태**: 현재 동작 상태를 배지로 표시합니다.
- **UUID / ID**: 인스턴스를 식별하는 고유값입니다.
- **생성 일시**: 생성된 날짜/시간입니다.
- **VPC**: 연결된 가상 네트워크입니다.
- **인스턴스 타입**: 선택한 사양 이름입니다. (사용 시)
- **GPU**: 패스스루 사용 여부입니다.
- **vCPU / 메모리 크기**: 현재 할당자원입니다.
- **최대 vCPU / 최대 메모리 크기**: 실행 중 확장을 위한 상한(설정 시 표시)입니다.
- **물리 머신**: 현재 실행 중인 호스트입니다.
- **Cloud-init**: 초기 계정/암호 설정 여부가 표시됩니다.
- **생성 방식**: 직접 생성/템플릿/그룹 등 생성 출처가 표시됩니다.
- **이미지**: 부팅에 사용된 OS 이미지입니다.
- **시작 템플릿**: 템플릿 기반 생성 시 템플릿 정보가 표시됩니다.

> 💡 **버튼 활성 조건:** `콘솔`은 인스턴스가 **실행 중**일 때만 활성화됩니다.

### 하단 탭
- **네트워크 인터페이스**: NIC, 서브넷, 보안그룹, IP, MAC 정보를 표로 제공합니다. *(기본 NIC는 편집에서 삭제할 수 없습니다.)*
- **디스크**: 부팅/데이터 디스크의 ID, 크기, 장치명 등을 표시합니다. 편집은 생성/편집 페이지에서 수행합니다.
- **모니터링**: CPU·메모리·디스크·네트워크 지표를 그래프로 제공합니다. 기간 선택, CSV 내보내기를 지원합니다.
- **스냅샷**: 스냅샷 목록과 `삭제`, `롤백`을 제공합니다. 롤백은 **전원 꺼짐(정지됨)** 상태에서만 가능합니다.
  > 💡 새 스냅샷은 목록 화면 `더보기 ▸ 스냅샷 생성`에서 만듭니다.
- **파일 시스템**: 마운트된 파일 시스템(이름, 마운트 경로, 크기)을 표시합니다.
- **플로팅 IP**: 연결된 공인 IP의 이름/ID/VPC/외부 IP/자원 IP/할당 일시를 표시합니다.
- **선호도 그룹**: 배치 정책(선호/반선호) 그룹 정보를 제공합니다.
- **사용자 스크립트**: Cloud-init 사용자 스크립트의 실행 순서/이름/경로/단계/내용을 확인용으로 제공합니다.

---

## 생성·편집

> 생성과 편집은 같은 양식을 사용합니다. **편집 모드 차이**만 별도 표기합니다.

### 1. 기본 정보
- **인스턴스 이름**: 프로젝트 내 고유한 이름을 입력합니다.
- **인스턴스 사양 선택**
  - `인스턴스 타입 선택`: 미리 정의된 사양을 선택합니다. (GPU 포함 타입은 별도 표시)
  - `직접 입력`: vCPU, 메모리를 직접 지정합니다. (단위: `GiB`)
  - *(편집)* **실행 중** 편집은 **증설(상향)** 만 가능합니다. 감축은 제한됩니다.
- **GPU 사용**: GPU 패스스루 사용 여부를 선택합니다.  
  *(편집)* 생성 후 **변경 불가**입니다.
- **OS 이미지**: 부팅에 사용할 이미지를 선택합니다.  
  *(편집)* 이미지 변경은 **불가**합니다.
- **부트 디스크 크기**: 이미지 기본 크기 이상으로 확장 가능합니다.  
  *(편집)* 변경 **불가**입니다.

#### 입력 필드 유효성
| 필드 | 허용 값 | 검증 규칙 | 비고 |
|------|---------|-----------|------|
| **인스턴스 이름** | 최대 30자(영문/숫자/`-`) | 첫 글자 숫자 불가, 공백/특수문자 불가 | **필수** |
| **vCPU** | 1,2,4,8… (정수) | *(편집)* 현재 값 **이상**만 입력 | 최소 1 |
| **메모리** | 정수 또는 0.5 단위 `GiB` | *(편집)* 현재 값 **이상**만 입력 | 단위 `GiB` |
| **부트 디스크** | 이미지 기본 크기 이상 | 소수점 불가 | 기본값=이미지 크기 |

> ⚠️ **실행 중 편집(라이브 업데이트):** vCPU/메모리 **증설만 가능**합니다. 이미지, GPU, 부트 디스크, **기본 NIC 삭제**는 불가합니다.

### 2. 네트워크 설정
- **네트워크(VPC) 선택**: 연결할 VPC를 지정합니다. *(편집)* VPC 자체 변경은 불가합니다.
- **네트워크 인터페이스(NIC)**
  - **서브넷**: 각 NIC가 속할 서브넷을 선택합니다.
  - **IP 주소**: 미입력 시 자동 할당, 수동 입력 시 유효한 IPv4 형식 필요.
  - **보안그룹**: 트래픽 규칙 적용용으로 다중 선택 가능(최대 5개).
- **NIC 추가/삭제**
  - `+ 추가`로 비기본 NIC를 추가합니다.
  - 최소 1개는 유지되어야 하며, **기본 NIC는 삭제 불가**입니다.
  - *(실행 중)* 비기본 NIC 추가/제거는 가능할 수 있으나 OS 인식에 재부팅/설정이 필요할 수 있습니다.

#### 입력/검증 규칙
| 항목 | 설명 | 비고 |
|-----|-----|-----|
| **서브넷** | 선택한 VPC 내 서브넷 중 지정 | – |
| **IPv4 주소** | `A.B.C.D` 형식 유효성 검증 | 미입력 시 자동 할당 |
| **보안그룹** | 다중 선택(최대 5개) | 방화벽 규칙 적용 |

> 💡 VPC 변경이 필요하면 새 인스턴스 생성이 권장됩니다.

### 3. GPU 설정(패스스루)
- **GPU 패스스루 사용**: 체크 시 GPU 자원이 할당됩니다. GPU 호스트 가용성이 필요합니다.  
  *(편집)* 생성 후 변경 불가.

> 💡 GPU 인스턴스 수량은 가용 물리 GPU 수량에 의해 제한됩니다.

### 4. 스토리지 설정(추가 디스크)
- **블록 디바이스(볼륨) 추가**: 기존/새 볼륨을 선택해 부착합니다. 잘못 추가한 항목은 선택 후 `삭제`로 제거합니다.  
  *(실행 중)* 데이터 디스크는 핫플러그 추가/제거가 가능할 수 있으나 **부팅 디스크는 불가**합니다.
- **파일 시스템 추가**: NFS 등 파일 시스템 자원을 선택해 마운트합니다. 네트워크 연결 조건이 충족되어야 버튼이 활성화됩니다.  
  *(실행 중 편집)* 일부 파일 시스템은 안전한 마운트 해제를 위해 재시작이 필요할 수 있습니다.

### 5. Cloud-init 설정(초기 스크립트)
- **사용자 이름**: 최초 로그인 계정명입니다.
- **비밀번호 설정/확인**: 입력 시 두 칸이 일치해야 합니다. 미설정 시 키 기반 접속 등 별도 방법이 필요합니다.
- **사용자 데이터 스크립트**
  - `+ 스크립트 추가`로 여러 개 등록 가능, **실행 순서**대로 처리됩니다.
  - **실행 단계**: `PER-BOOT`(부팅 시마다), `PER-INSTANCE`(해당 인스턴스 첫 부팅 1회), `PER-ONCE`(해당 이미지로 최초 1회).

#### 입력 필드 유효성
| 필드 | 허용 값 | 검증 규칙 | 비고 |
|------|---------|-----------|------|
| **사용자 이름** | 4~20자, 소문자/숫자/`_`/`-` | 첫 글자 **영문 소문자** | **필수** |
| **비밀번호/확인** | 4~20자(영/숫/특수 일부) | 두 값 일치 | 선택(입력 시 확인 필수) |

> ⚠️ 일부 변경은 즉시 적용되지만(예: vCPU/메모리 증설), NIC 추가 등은 OS 인식/재부팅이 필요할 수 있습니다. 유지보수 창을 확보해 적용을 권장합니다.
