# 쿠버네티스 클러스터 관리 가이드

CloudiA 콘솔에서 쿠버네티스 클러스터를 생성하고, 노드·스토리지·리소스를 관리하는 절차를 단계별로 설명합니다.

## 한눈에 보기
- **기능 목적**: 쿠버네티스 클러스터의 생성·확장·삭제 및 모니터링 절차 안내  
- **포함 화면**: 클러스터 생성 → 상세 정보 → 노드/스토리지/리소스 관리  
- **주요 작업 흐름**
  1. 클러스터 생성
  2. 클러스터 상세 확인 및 `Config 추출`
  3. 워커 노드 추가 및 삭제
  4. 스토리지 클래스/PVC 생성
- **핵심 액션**: `생성`, `워커 노드 추가`, `스토리지 클래스 생성`, `PVC 생성`

---

## 클러스터 생성
### 화면 개요
새 클러스터 생성 시 기본 정보, 네트워크, 컨트롤 플레인, 인증서, Cloud-Init 정보를 입력합니다.

#### 1. 기본 정보
- **클러스터 이름**: 영문 소문자·숫자 사용, 길이 제한 존재  
  유효하지 않은 문자 입력 시 `"유효하지 않은 클러스터 이름입니다."` 메시지 표시

#### 2. 네트워크 설정
- **VPC/서브넷 선택**: 연결할 네트워크 지정  
- **보안 그룹 선택**: 클러스터 노드 방화벽 규칙 선택 (1개 이상 필수)

#### 3. 컨트롤 플레인 설정
- **쿠버네티스 이미지 선택**  
- **부팅 디스크 크기**: 기본 64 GiB  
- **인스턴스 타입 / 노드 수**: 일반 1개, 고가용성은 3개 선택 가능

#### 4. 인증서 업로드
- **CA 인증서 / 개인 키 파일**: 필수 업로드  
  형식 오류 시 `"CA 인증서 파일을 확인하세요."` 표시

#### 5. Cloud-Init 설정
- **사용자 이름** 입력  
- **비밀번호(선택)**: 미입력 시 키 기반 로그인 적용

#### 6. 생성 실행
- 모든 필드 입력 후 `생성` 버튼 클릭 → 목록으로 복귀  
- 클러스터 상태: `생성 중` → 완료 시 `활성(UP)`  
- `취소` 클릭 시 작업 중단

---

## 클러스터 상세
### 화면 개요
클러스터 이름 클릭 시 상세 페이지로 이동합니다. 상단에 기본 정보와 `Config 추출` 버튼이 있습니다.

| 항목 | 설명 |
|------|------|
| **클러스터 이름/ID** | 식별 정보 |
| **VPC/서브넷** | 연결 네트워크 정보 |
| **엔드포인트 IP** | API 서버 주소 |
| **상태/생성 일시** | 클러스터 상태 및 생성 시간 |

### 주요 탭 구성
#### 모니터링 탭
- 클러스터 노드 상태, CPU 부하, 파드 상태 표시  
- 임계치 초과 시 색상 경고(노란색/빨간색)  
- `자동 새로고침` 기능 제공  

#### 컴퓨트 탭
| 버튼 | 기능 설명 |
|------|------------|
| **실행** | 오프라인/중지 워커 노드 재가동 |
| **워커 노드 추가** | 클러스터 `UP` 상태일 때 활성화 |
| **워커 노드 삭제** | 삭제 가능한 워커 노드 선택 후 제거 |

> 💡 참고: 노드 이름 클릭 시 VM 상세 화면으로 이동하여 CPU/메모리, 로그 등 세부 모니터링이 가능합니다.

#### 네트워크 탭
- **VPC/서브넷/보안 그룹** 정보 표시 (읽기 전용)  
- 네트워크 변경은 클러스터 재생성 또는 별도 메뉴에서 수행합니다.

#### 스토리지 탭
- **스토리지 클래스 / PVC** 전환 가능  
- 각 목록에 `생성` 버튼 제공  
- **스토리지 클래스**: 이름, 바인딩 모드, 볼륨 확장 여부  
- **PVC**: 이름, 용량, 접근 모드, 상태(Pending/Bound)

#### 리소스 탭
- 리소스 유형 선택: 시스템 파드, 디플로이먼트, 서비스, 데몬셋, 이벤트  
- 조회 전용이며, 상세 작업은 `kubectl` 등 외부 도구로 수행합니다.

---

## 워커 노드 추가
### 화면 개요
클러스터 확장을 위해 `컴퓨트` 탭의 `워커 노드 추가` 버튼을 클릭합니다.  
클러스터 상태가 **UP**이며 컨트롤 플레인이 준비되어 있어야 합니다.

#### 1. 노드 설정
| 필드 | 설명 |
|------|------|
| **노드 타입** | 인스턴스 사양 선택 (vCPU, 메모리 등) |
| **이미지 선택** | 컨트롤 플레인과 동일한 버전 권장 |
| **부팅 디스크 크기** | 기본값 제공, 필요 시 조정 |
| **노드 수** | 동시에 여러 대 추가 가능 (시스템 최대 허용 범위 내) |

#### 2. Cloud-Init 계정 설정
- 사용자 이름 입력  
- (선택) 비밀번호 및 확인 입력

#### 3. 가용 IP 확인
- 서브넷 내 잔여 IP 자동 조회  
- 가용 IP보다 추가 수가 많으면 `"가용 IP 수를 초과했습니다."` 메시지 표시

#### 4. 생성 실행
- `생성` 클릭 시 새 노드가 `생성 중` 상태로 표시  
- 완료 후 `Ready` 상태로 전환  
> 💡 참고: 추가 완료 후 스케줄러가 자동으로 파드를 분산시킵니다.

---

## 스토리지 관리
### 스토리지 클래스 생성
1. **스토리지 탭** → `스토리지 클래스` 선택 → `스토리지 클래스 생성` 클릭  
2. **입력 항목**
   - **이름**: 소문자·숫자·하이픈만 허용 (예: `premium-storage-class`)  
   - **파일 시스템 선택**: 등록된 NFS/CephFS 등 선택  
   - **반환 정책**: `Delete` 또는 `Retain`  
3. **생성 후 결과**
   - 성공 시 “스토리지 클래스 생성이 완료되었습니다.” 표시  
   - 오류 시 원인 메시지 출력

### PVC 생성
1. **스토리지 탭** → `PVC` 전환 → `PVC 생성` 클릭  
2. **입력 항목**
   - **이름**: 소문자·숫자·하이픈 (예: `my-app-pvc`)  
   - **용량**: MiB 단위 정수 (예: 10240 MiB = 10 GiB)  
   - **스토리지 클래스**: 드롭다운에서 선택  
   - **Namespace**: `default` 등 네임스페이스 지정  
   - **액세스 모드**: `ReadOnlyMany` 또는 `ReadWriteMany`  
3. **생성 후 상태**
   - 초기 상태 `Pending` → 볼륨 바인딩 후 `Bound`  
   - 이벤트 탭에서 `"Successfully provisioned volume"` 확인 가능  

---

## 리소스 확인
- **시스템 파드**: CoreDNS, kube-proxy 등 시스템 컴포넌트 상태 확인  
- **디플로이먼트**: 준비된 파드 수, 네임스페이스, 업데이트 일시 표시  
- **서비스**: ClusterIP, 포트, 셀렉터 정보  
- **데몬셋**: 각 노드 배치형 파드 현황  
- **이벤트**: 정상/경고 메시지 시간순 정렬  

