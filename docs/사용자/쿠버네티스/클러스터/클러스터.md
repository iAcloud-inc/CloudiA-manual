# 클러스터 사용자 가이드

## 클러스터 목록

프로젝트의 모든 **쿠버네티스 클러스터**를 한눈에 확인할 수 있습니다. 테이블에는 **이름**, **ID**, **엔드포인트 IP**, **상태**, **컨트롤 플레인**, **워커 노드**, **생성 일시** 등의 컬럼이 표시됩니다. 각 컬럼의 의미는 다음과 같습니다:

- **이름**: 클러스터 이름입니다. 이름을 클릭하면 해당 클러스터의 상세 페이지로 이동합니다.
- **ID**: 클러스터에 부여된 고유 ID입니다.
- **엔드포인트 IP**: API 서버에 연결하는 엔드포인트 IP입니다.
- **상태**: 클러스터의 동작 상태입니다. 예: **실행 중(UP)**, **에러**, **생성 중**, **삭제 중** 등.
- **컨트롤 플레인**: 정상 노드 수/전체 노드 수(예: `1/1`).
- **워커 노드**: 정상 노드 수/전체 노드 수(예: `3/3`).
- **생성 일시**: 클러스터가 생성된 날짜와 시간입니다.

목록 상단 도구 모음에서는 다음 작업을 수행할 수 있습니다:

- **생성**: 새 클러스터 생성 페이지로 이동합니다.
- **삭제**: 하나 이상 선택 시 활성화됩니다. 이미 **삭제 중** 상태인 클러스터는 삭제할 수 없습니다.

> 참고: 목록에서 행을 클릭하거나 이름을 클릭하면 **클러스터 상세** 페이지로 이동합니다.

## 클러스터 생성

클러스터 생성 페이지에서 다음 항목을 순서대로 설정합니다.

1) **클러스터 이름**  
   - 영문 소문자/숫자만 사용하며 길이 제한이 있습니다. 유효하지 않은 문자는 즉시 오류로 안내됩니다.
2) **네트워크 선택**  
   - **VPC**: 사용할 VPC를 선택합니다.
   - **서브넷**:  
     - 클러스터 생성 시 **퍼블릭 서브넷**만 선택 가능합니다.
   - **보안 그룹**  
     - 쿠버네티스 클러스터가 정상적으로 작동하려면 특정 포트들이 열려 있어야 합니다.
     - 선택한 보안 그룹에서 **필수 포트가 차단되지 않았는지** 확인하세요.
     - 포트 목록:
       - **2379–2380**: etcd 서버 클라이언트 API
       - **6443**: Kubernetes API 서버
       - **6400**: cks mgmt
       - **10250**: kubelet API
       - **10251**: kube-scheduler
       - **10252**: kube-controller-manager
       - **30000–32767**: NodePort 서비스 범위 (선택)

3) **컨트롤 플레인 설정**  
   - **이미지**(OS+K8s 버전) → **부팅 디스크 크기**(예: 기본 32GiB) → **인스턴스 타입** → **노드 수**(일반 1개, 고가용성 3개 권장) 순서로 지정합니다.
4) **인증서 업로드(필수)**  
   - **CA 인증서**와 **개인 키** 파일을 업로드합니다(컨트롤 플레인 인증 설정에 사용).
5) **Cloud-Init 설정(선택)**
   - 사용자명은 필수, 비밀번호는 옵션입니다(키 기반 접근 가능).
6) **생성/취소**  
   - 필수값 충족 시 **[생성]**이 활성화됩니다. 요청이 접수되면 목록으로 복귀하며 상태가 **생성 중**으로 표시됩니다. 준비 완료 시 **실행 중(UP)** 상태가 됩니다.

## 클러스터 상세

선택한 클러스터의 구성과 상태를 종합적으로 확인합니다. 상단에는 **기본 정보**가 표 형태로 표시되고, 하단 탭에서 세부 정보를 확인합니다.

상단 기본 정보에는 다음 항목이 표시됩니다:

- **이름**
- **ID**
- **VPC**
- **엔드포인트 IP**(API 서버)
- **상태**
- **생성 일시**

상단 버튼:

- **[Config 추출]**: kubeconfig 확인/다운로드(외부 `kubectl` 연결 설정)


하단 탭에서는 **모니터링, 컴퓨트, 네트워크, 스토리지, 리소스**에 대한 세부 정보를 제공합니다.
- 클러스터가 생성 중인 경우, **컴퓨트, 네트워크** 탭만 조회 가능합니다.

### 모니터링
- 컨트롤 플레인/워커 노드 상태, 평균 CPU 사용률, 파드 상태(Running/Failed 수) 등을 한눈에 볼 수 있습니다.
- 임계치에 따라 색상으로 강조 표시되며, 우측 상단에서 **자동 새로고침** 주기를 설정할 수 있습니다.
> 참고: 클러스터 초기화 직후에는 일부 지표가 아직 준비되지 않았을 수 있습니다.

### 컴퓨트(노드)
- 노드 목록 열: **역할(컨트롤 플레인/워커), 노드 이름, 노드 ID, K8s 버전, IP, 인스턴스 타입, 상태, 생성 일시**
- 도구 모음 작업:
  - **실행**: 선택 워커 노드가 NotReady/Pending/오프라인일 때 재가동 요청
  - **워커 노드 추가**: 클러스터 상태가 **UP**일 때 활성화
  - **워커 노드 삭제**: 워커 1대 선택 + 컨트롤 플레인 아님 + 생성/삭제 진행 중 아님 → 확인 후 제거(해당 VM 자원도 종료)
- 노드 이름을 클릭하면 **VM 인스턴스 상세**로 이동해 심층 모니터링(CPU/메모리, 로그 등)이 가능합니다.

#### 워커 노드 추가
1) 시작: **컴퓨트** 탭의 **[워커 노드 추가]**(클러스터 **UP**, 컨트롤 플레인 준비 완료 필요)  
2) 설정 입력  
   - **노드 타입(인스턴스 타입)** 선택(권장 스펙 제공)  
   - **노드 이미지**(OS+K8s 버전) 선택(컨트롤 플레인과 동일 버전 권장)  
   - **부팅 디스크 크기** 설정(기본값/유효 범위 검증)  
   - **노드 수** 지정(동시 추가 가능, 시스템이 안내하는 최대 허용 대수 내)  
   - **Cloud-Init 계정**: 사용자명, (옵션) 비밀번호/확인  

### 네트워크
- 연결 정보: **서브넷 이름/ID, 보안 그룹 목록**, **컨트롤 플레인 로드밸런서 이름/ID**

### 스토리지
- 상단 전환에서 **스토리지 클래스**와 **PVC**를 선택해 각각의 목록을 확인합니다. 선택된 유형에 따라 **[스토리지 클래스 생성]** 또는 **[PVC 생성]** 버튼이 제공됩니다.

#### 스토리지 클래스
- 스토리지 클래스 목록: **이름, 경과 시간, 볼륨 확장 허용 여부, 서버, 공유 경로, 프로비저너, 반환 정책, 바인딩 모드, 기본**
- 스토리지 클래스 생성
   1) 진입: **스토리지** 탭에서 **[스토리지 클래스]** 선택 → **[스토리지 클래스 생성]**  
   2) 입력 항목  
      - **이름**: Kubernetes 명명 규칙(소문자/숫자/`-`) 준수(예: `premium-storage-class`)  
      - **파일 시스템/스토리지 도메인 선택**: **[선택]** 버튼으로 연결 대상 지정(NFS/CephFS 등)  
      - **반환 정책(Reclaim Policy)**: **Delete** 또는 **Retain** 선택  
   3) 생성/결과: **[생성]** 후 목록에 추가, 성공 알림 확인. 생성된 클래스는 이후 **PVC 생성 시 지정** 가능

#### PVC
- PVC 목록: **이름, 경과 시간, 상태(Pending/Bound), 스토리지 클래스, 볼륨, 설정 용량, 접근 모드(ReadOnlyMany/ReadWriteMany)**
- PVC 생성
   1) 진입: **스토리지** 탭 상단에서 **PVC** 전환 → **[PVC 생성]**  
   2) 입력 항목  
      - **이름**: 소문자/숫자/`-` 규칙, 고유해야 함(예: `my-app-pvc`)  
      - **용량**: **MiB 단위 정수(≥1)** 입력(예: `10240` = 10GiB)  
      - **스토리지 클래스**: 드롭다운에서 선택(없으면 먼저 스토리지 클래스를 생성)  
      - **네임스페이스**: 대상 네임스페이스 선택(예: `default`)  
      - **액세스 모드**: **ReadOnlyMany** 또는 **ReadWriteMany**  
   3) 생성/상태: **[생성]** 후 **PVC 목록**에 추가. 초기 **Pending** → 프로비저닝 완료 시 **Bound**  
   4) 사용: 디플로이먼트/파드 매니페스트에서 해당 PVC를 마운트하여 영구 스토리지 사용

### 리소스
- 리소스 종류 선택: **시스템 파드 / 디플로이먼트 / 서비스 / 데몬셋 / 이벤트**
- 시스템 파드: `kube-system` 등 핵심 컴포넌트 상태/재시작 횟수/노드 배치 확인
- 디플로이먼트: 이름/네임스페이스/준비 파드 수/요구 수/업데이트 일시 등
- 서비스: 타입(ClusterIP/LoadBalancer 등), 클러스터 IP, 포트, 셀렉터
- 데몬셋: 전 노드 배치형 에이전트(예: 로그 수집기) 현황
- 이벤트: 시간순 로그로 주요 상황 파악  
> 참고: 이 탭은 조회 전용입니다. 문제 발견 시 `kubectl` 또는 CI/CD로 조치하세요.

 

## 변경 이력
- 2025-10-15: 최초 작성

